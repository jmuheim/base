dist: trusty
language: ruby
rvm:
  - 2.4.1
bundler_args: --without development
cache: bundler
sudo: required
addons:
  apt_packages:
    - pandoc
  code_climate:
    repo_token: 243e5ab59244b7a1d3fb97d56bfe9961307ad558cb4a7cbeec3c85104e9ee11b
  chrome: stable
before_install:
  - export TZ=Europe/Zurich
  - mysql -e 'CREATE DATABASE base_test'
  - google-chrome-stable --headless --disable-gpu --remote-debugging-port=9222 http://localhost &

before_script:
  - cp config/secrets.travis.yml config/secrets.yml
  - export DISPLAY=:99.0 && sh -e /etc/init.d/xvfb start && sleep 3

script:
  - RAILS_ENV=test bundle exec rails db:create
  - RAILS_ENV=test bundle exec rails db:migrate
  -                bundle exec rails spec
notifications:
  email:
    recipients:
      - joshua.muheim@access-for-all.ch
    on_failure: change
    on_success: change
